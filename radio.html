<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>How Internet Radio Works</title>
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Fraunces:opsz,wght@9..144,400;9..144,700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #0a0a0f;
        --surface: #12121a;
        --border: #1e1e2e;
        --accent: #ff6b3d;
        --accent-dim: #ff6b3d33;
        --text: #e8e4df;
        --text-dim: #7a7680;
        --green: #3ddc84;
        --green-dim: #3ddc8422;
        --blue: #5b9cf5;
        --yellow: #f5c842;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background: var(--bg);
        color: var(--text);
        font-family: "JetBrains Mono", monospace;
        min-height: 100vh;
        overflow-x: hidden;
      }

      .grain {
        position: fixed;
        inset: 0;
        z-index: 100;
        pointer-events: none;
        opacity: 0.03;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 60px 24px;
      }

      h1 {
        font-family: "Fraunces", serif;
        font-size: clamp(2rem, 5vw, 3.2rem);
        font-weight: 700;
        line-height: 1.15;
        margin-bottom: 12px;
        background: linear-gradient(135deg, var(--accent), var(--yellow));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .subtitle {
        color: var(--text-dim);
        font-size: 0.85rem;
        margin-bottom: 48px;
        letter-spacing: 0.5px;
      }

      /* ‚îÄ‚îÄ Player Card ‚îÄ‚îÄ */
      .player-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 32px;
        margin-bottom: 48px;
        position: relative;
        overflow: hidden;
      }

      .player-card::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle at 30% 40%,
          var(--accent-dim),
          transparent 50%
        );
        pointer-events: none;
      }

      .station-info {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 24px;
        position: relative;
      }

      .station-icon {
        width: 64px;
        height: 64px;
        background: linear-gradient(135deg, var(--accent), #ff3d6b);
        border-radius: 14px;
        display: grid;
        place-items: center;
        font-size: 28px;
        flex-shrink: 0;
        box-shadow: 0 8px 24px var(--accent-dim);
      }

      .station-name {
        font-family: "Fraunces", serif;
        font-size: 1.4rem;
        font-weight: 700;
      }

      .station-genre {
        color: var(--text-dim);
        font-size: 0.75rem;
        margin-top: 4px;
        text-transform: uppercase;
        letter-spacing: 1.5px;
      }

      .live-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: var(--green-dim);
        color: var(--green);
        font-size: 0.65rem;
        font-weight: 700;
        padding: 4px 10px;
        border-radius: 100px;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-top: 6px;
      }

      .live-dot {
        width: 6px;
        height: 6px;
        background: var(--green);
        border-radius: 50%;
        animation: pulse 1.5s ease infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.4;
          transform: scale(0.7);
        }
      }

      .controls {
        display: flex;
        align-items: center;
        gap: 16px;
        position: relative;
      }

      .play-btn {
        width: 56px;
        height: 56px;
        border-radius: 50%;
        border: none;
        background: var(--accent);
        color: #fff;
        font-size: 22px;
        cursor: pointer;
        display: grid;
        place-items: center;
        transition: all 0.2s ease;
        box-shadow: 0 4px 20px var(--accent-dim);
        flex-shrink: 0;
      }

      .play-btn:hover {
        transform: scale(1.08);
        filter: brightness(1.15);
      }
      .play-btn:active {
        transform: scale(0.95);
      }

      .volume-wrap {
        display: flex;
        align-items: center;
        gap: 10px;
        flex: 1;
      }

      .vol-icon {
        color: var(--text-dim);
        font-size: 0.8rem;
      }

      input[type="range"] {
        -webkit-appearance: none;
        flex: 1;
        height: 4px;
        border-radius: 2px;
        background: var(--border);
        outline: none;
        max-width: 200px;
      }

      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 14px;
        height: 14px;
        border-radius: 50%;
        background: var(--accent);
        cursor: pointer;
        box-shadow: 0 0 8px var(--accent-dim);
      }

      .status-bar {
        margin-top: 20px;
        padding-top: 16px;
        border-top: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        font-size: 0.7rem;
        color: var(--text-dim);
      }

      .visualizer {
        display: flex;
        align-items: flex-end;
        gap: 2px;
        height: 32px;
        margin-left: auto;
        margin-right: 16px;
      }

      .viz-bar {
        width: 3px;
        background: var(--accent);
        border-radius: 2px;
        transition: height 0.15s ease;
        opacity: 0.6;
      }

      .viz-bar.active {
        opacity: 1;
      }

      /* ‚îÄ‚îÄ Explainer Sections ‚îÄ‚îÄ */
      .section {
        margin-bottom: 40px;
      }

      .section-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
      }

      .step-num {
        width: 32px;
        height: 32px;
        border-radius: 8px;
        background: var(--accent-dim);
        color: var(--accent);
        font-size: 0.8rem;
        font-weight: 700;
        display: grid;
        place-items: center;
        flex-shrink: 0;
      }

      .section h2 {
        font-family: "Fraunces", serif;
        font-size: 1.2rem;
        font-weight: 700;
      }

      .section p {
        color: var(--text-dim);
        font-size: 0.82rem;
        line-height: 1.75;
        margin-bottom: 12px;
      }

      .section p strong {
        color: var(--text);
      }

      code.inline {
        background: var(--accent-dim);
        color: var(--accent);
        padding: 2px 7px;
        border-radius: 4px;
        font-size: 0.78rem;
      }

      .code-block {
        background: #0d0d14;
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 20px;
        margin: 16px 0;
        overflow-x: auto;
        font-size: 0.78rem;
        line-height: 1.7;
        color: var(--text-dim);
      }

      .code-block .tag {
        color: var(--accent);
      }
      .code-block .attr {
        color: var(--blue);
      }
      .code-block .val {
        color: var(--green);
      }
      .code-block .comment {
        color: #444;
        font-style: italic;
      }

      .diagram {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 28px;
        margin: 20px 0;
        text-align: center;
        font-size: 0.78rem;
        color: var(--text-dim);
        line-height: 2;
      }

      .diagram .flow {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        flex-wrap: wrap;
      }

      .diagram .node {
        background: var(--accent-dim);
        color: var(--accent);
        padding: 6px 14px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.72rem;
        white-space: nowrap;
      }

      .diagram .arrow {
        color: var(--text-dim);
        font-size: 1.1rem;
      }

      .highlight-box {
        background: linear-gradient(135deg, #5b9cf511, #5b9cf506);
        border-left: 3px solid var(--blue);
        border-radius: 0 8px 8px 0;
        padding: 16px 20px;
        margin: 16px 0;
        font-size: 0.78rem;
        line-height: 1.7;
        color: var(--text-dim);
      }

      .highlight-box strong {
        color: var(--blue);
      }

      footer {
        margin-top: 60px;
        padding-top: 24px;
        border-top: 1px solid var(--border);
        font-size: 0.7rem;
        color: var(--text-dim);
        text-align: center;
        line-height: 1.8;
      }
    </style>
  </head>
  <body>
    <div class="grain"></div>
    <div class="container">
      <h1>How Internet Radio Streaming Works</h1>
      <p class="subtitle">
        An interactive explainer ‚Äî press play and read along
      </p>

      <!-- ‚îÄ‚îÄ Player ‚îÄ‚îÄ -->
      <div class="player-card">
        <div class="station-info">
          <div class="station-icon">üìª</div>
          <div>
            <div class="station-name" id="stationName">Select a station...</div>
            <div class="station-genre" id="stationGenre">‚Äî</div>
            <div class="live-badge">
              <div class="live-dot"></div>
              Live Stream
            </div>
          </div>
        </div>
        <div class="controls">
          <button class="play-btn" id="playBtn" onclick="togglePlay()">
            ‚ñ∂
          </button>
          <div class="volume-wrap">
            <span class="vol-icon">üîà</span>
            <input
              type="range"
              id="volume"
              min="0"
              max="1"
              step="0.01"
              value="0.7"
              oninput="setVolume(this.value)"
            />
          </div>
          <div class="visualizer" id="visualizer"></div>
        </div>
        <div class="status-bar">
          <span id="status">Stopped</span>
          <span id="format">‚Äî</span>
        </div>

        <!-- Station Selector -->
        <div style="margin-top: 16px; display: flex; gap: 8px; flex-wrap: wrap">
          <button
            onclick="selectStation(0)"
            class="play-btn"
            style="
              width: auto;
              height: auto;
              border-radius: 8px;
              font-size: 0.7rem;
              padding: 6px 14px;
              font-family: inherit;
            "
          >
            Beu FM üá∞üáø
          </button>
          <button
          onclick="selectStation(1)"
          class="play-btn"
          style="
            width: auto;
            height: auto;
            border-radius: 8px;
            font-size: 0.7rem;
            padding: 6px 14px;
            font-family: inherit;
          "
        >
          Zhuldyz FM ‚≠ê
        </div>
      </div>

      <!-- ‚îÄ‚îÄ Explainer ‚îÄ‚îÄ -->

      <div class="section">
        <div class="section-header">
          <div class="step-num">1</div>
          <h2>The Core Idea: It's Just an Audio File That Never Ends</h2>
        </div>
        <p>
          Internet radio is surprisingly simple at its heart. A radio station
          runs a <strong>streaming server</strong> that continuously sends audio
          data over HTTP ‚Äî exactly like downloading an MP3, except
          <strong>the download never finishes</strong>. Your browser starts
          playing audio as bytes arrive rather than waiting for a complete file.
        </p>
        <div class="diagram">
          <div class="flow">
            <span class="node">üé§ Audio Source</span>
            <span class="arrow">‚Üí</span>
            <span class="node">üîß Encoder</span>
            <span class="arrow">‚Üí</span>
            <span class="node">üñ• Stream Server</span>
            <span class="arrow">‚Üí HTTP ‚Üí</span>
            <span class="node">üåê Your Browser</span>
            <span class="arrow">‚Üí</span>
            <span class="node">üîä Speakers</span>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-header">
          <div class="step-num">2</div>
          <h2>The Simplest Possible Code</h2>
        </div>
        <p>
          All you need is a single HTML
          <code class="inline">&lt;audio&gt;</code> element pointed at a stream
          URL. That's literally it:
        </p>
        <div class="code-block">
          <span class="comment"
            >&lt;!-- This is a complete, working internet radio player
            --&gt;</span
          ><br />
          <span class="tag">&lt;audio</span> <span class="attr">src</span>=<span
            class="val"
            >"https://stream.example.com/radio.mp3"</span
          ><br />
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="attr"
            >controls</span
          ><br />
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="attr"
            >crossorigin</span
          >=<span class="val">"anonymous"</span><span class="tag">&gt;</span
          ><br />
          <span class="tag">&lt;/audio&gt;</span>
        </div>
        <p>
          The browser's built-in
          <code class="inline">&lt;audio&gt;</code> element handles buffering,
          decoding, and playback. The
          <code class="inline">crossorigin</code> attribute is needed when the
          stream comes from a different domain (CORS). That's the entire
          front-end technology.
        </p>
      </div>

      <div class="section">
        <div class="section-header">
          <div class="step-num">3</div>
          <h2>Streaming Protocols: How Bytes Travel</h2>
        </div>
        <p>There are a few protocols used to deliver audio streams:</p>
        <p>
          <strong>ICY / SHOUTcast</strong> ‚Äî The original internet radio
          protocol from the late '90s. It's plain HTTP with a twist: the server
          injects metadata (song title, artist) directly into the byte stream at
          regular intervals. The header
          <code class="inline">Icy-MetaData: 1</code> requests this. Most
          internet radio stations still use this today.
        </p>
        <p>
          <strong>HLS (HTTP Live Streaming)</strong> ‚Äî Apple's protocol. Instead
          of one infinite stream, the server chops audio into small
          <code class="inline">.ts</code> segment files (usually 2‚Äì10 seconds
          each) and serves a <code class="inline">.m3u8</code> playlist that
          your player reads to know which segment to fetch next. This is how
          most podcast and music apps work.
        </p>
        <p>
          <strong>Plain HTTP progressive download</strong> ‚Äî The simplest: just
          an MP3/AAC served over regular HTTP. The browser reads it
          progressively. No special protocol needed. This is what our player
          above uses.
        </p>
        <div class="highlight-box">
          <strong>Key insight:</strong> Unlike WebSockets or WebRTC, internet
          radio is usually just plain old HTTP. The server sends a response with
          <code class="inline">Transfer-Encoding: chunked</code> or simply never
          closes the connection, and the browser's audio decoder consumes data
          as it arrives.
        </div>
      </div>

      <div class="section">
        <div class="section-header">
          <div class="step-num">4</div>
          <h2>Audio Codecs: Compressing Sound</h2>
        </div>
        <p>
          Raw audio (PCM) uses about <strong>1.4 Mbps</strong> for CD quality.
          That's too much for streaming, so codecs compress it:
        </p>
        <p>
          <strong>MP3</strong> (MPEG-1 Audio Layer 3) ‚Äî The classic. Most
          stations stream at 128 kbps or 192 kbps. Universally supported. The
          streams you see above use this.
        </p>
        <p>
          <strong>AAC</strong> (Advanced Audio Coding) ‚Äî Better quality at the
          same bitrate as MP3. Used by Apple Music, YouTube, and many modern
          streams. The <code class="inline">&lt;audio&gt;</code> element
          supports it natively.
        </p>
        <p>
          <strong>Ogg Vorbis / Opus</strong> ‚Äî Open-source alternatives. Opus is
          particularly impressive ‚Äî near-transparent quality at 96 kbps. Used by
          Discord, WhatsApp, and some indie radio stations.
        </p>
        <div class="highlight-box">
          <strong>How buffering works:</strong> When you press play, the browser
          downloads a few seconds of audio before starting playback (the
          "buffer"). If the network stalls, the buffer drains. If it empties,
          you hear silence until more data arrives. Most players buffer 2‚Äì5
          seconds ahead. You can see this buffer state with the
          <code class="inline">audio.buffered</code> API.
        </div>
      </div>

      <div class="section">
        <div class="section-header">
          <div class="step-num">5</div>
          <h2>The Server Side: Icecast & Friends</h2>
        </div>
        <p>
          The most popular open-source streaming server is
          <strong>Icecast</strong>. Here's the typical setup:
        </p>
        <p>
          A <strong>source client</strong> (like a DJ running software, or an
          automated playlist) encodes audio in real-time and pushes it to
          Icecast. Icecast then re-broadcasts that single stream to every
          connected listener. If 10,000 people are listening, Icecast sends
          10,000 copies of the same data.
        </p>
        <p>
          For large stations, a <strong>CDN</strong> (Content Delivery Network)
          sits in front to handle scale ‚Äî just like how Netflix uses CDNs for
          video.
        </p>
        <div class="diagram">
          <div class="flow">
            <span class="node">üéß DJ / Automation</span>
            <span class="arrow">‚Üí</span>
            <span class="node">Icecast Server</span>
            <span class="arrow">‚Üí</span>
            <span class="node">CDN (optional)</span>
            <span class="arrow">‚Üí</span>
            <span class="node">1000s of listeners</span>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-header">
          <div class="step-num">6</div>
          <h2>The Web Audio API: Visualizations & More</h2>
        </div>
        <p>
          The fake visualizer bars above are just CSS animation. But browsers
          provide a real <strong>Web Audio API</strong> that lets you analyze
          the actual audio waveform in real-time:
        </p>
        <div class="code-block">
          <span class="comment"
            >// Connect the audio element to an analyzer</span
          ><br />
          <span class="tag">const</span> ctx =
          <span class="tag">new</span> AudioContext();<br />
          <span class="tag">const</span> source =
          ctx.createMediaElementSource(audioEl);<br />
          <span class="tag">const</span> analyzer = ctx.createAnalyser();<br />
          source.connect(analyzer);<br />
          analyzer.connect(ctx.destination);<br /><br />
          <span class="comment">// Read frequency data every frame</span><br />
          <span class="tag">const</span> data =
          <span class="tag">new</span>
          Uint8Array(analyzer.frequencyBinCount);<br />
          <span class="tag">function</span> <span class="attr">draw</span>()
          {<br />
          &nbsp;&nbsp;analyzer.getByteFrequencyData(data);<br />
          &nbsp;&nbsp;<span class="comment"
            >// data[] now contains 0-255 amplitude per frequency bin</span
          ><br />
          &nbsp;&nbsp;<span class="comment"
            >// Use it to drive a canvas, SVG, or DOM visualizer</span
          ><br />
          &nbsp;&nbsp;requestAnimationFrame(draw);<br />
          }<br />
          draw();
        </div>
        <p>
          This is how music visualizers, equalizers, and beat-detection features
          work in web apps. Each frame, you get an array of amplitude values
          across the frequency spectrum that you can map to visual elements.
        </p>
      </div>

      <div class="section">
        <div class="section-header">
          <div class="step-num">7</div>
          <h2>CORS: The Biggest Headache</h2>
        </div>
        <p>
          Many radio streams work when you paste the URL directly into a browser
          tab, but fail when used in an
          <code class="inline">&lt;audio&gt;</code> tag. This is because of
          <strong>CORS</strong> (Cross-Origin Resource Sharing) ‚Äî a browser
          security policy that restricts cross-domain requests.
        </p>
        <p>
          For basic playback, CORS usually isn't an issue. But the moment you
          try to use the <strong>Web Audio API</strong> to analyze the stream
          (for visualizations), the browser requires the server to send
          <code class="inline">Access-Control-Allow-Origin</code> headers. Many
          old Icecast servers don't, which is why you'll see "CORS error" when
          trying to build visualizers for some stations.
        </p>
      </div>

      <footer>
        Built as an educational demo ¬∑ Streams provided by public internet radio
        stations<br />
        The <code class="inline">&lt;audio&gt;</code> element does all the heavy
        lifting ‚Äî the rest is just UI
      </footer>
    </div>

    <audio id="radio" preload="none"></audio>

    <script>
      // ‚îÄ‚îÄ Station list ‚îÄ‚îÄ
      const stations = [
        {
          name: "Beu FM",
          genre: "Pop KZ ¬∑ Almaty",
          url: "https://stream.beufm.kz/beufm",
          format: "MP3 ¬∑ 192 kbps ¬∑ ICY/HTTP ¬∑ 48kHz Stereo",
        },
        {
          name: "Zhuldyz FM",
          genre: "Kazakh Hits ¬∑ KZ",
          url: "http://91.201.214.229:8000/zhulduz",
          format: "MP3 ¬∑ ICY/HTTP",
        },
      ];

      const audio = document.getElementById("radio");
      const playBtn = document.getElementById("playBtn");
      const statusEl = document.getElementById("status");
      const formatEl = document.getElementById("format");
      let currentStation = null;
      let isPlaying = false;

      // ‚îÄ‚îÄ Create visualizer bars ‚îÄ‚îÄ
      const vizContainer = document.getElementById("visualizer");
      for (let i = 0; i < 16; i++) {
        const bar = document.createElement("div");
        bar.className = "viz-bar";
        bar.style.height = "4px";
        vizContainer.appendChild(bar);
      }
      const vizBars = vizContainer.querySelectorAll(".viz-bar");

      // ‚îÄ‚îÄ Station selection ‚îÄ‚îÄ
      function selectStation(index) {
        const station = stations[index];
        currentStation = station;
        document.getElementById("stationName").textContent = station.name;
        document.getElementById("stationGenre").textContent = station.genre;
        formatEl.textContent = station.format;

        const wasPlaying = isPlaying;
        if (isPlaying) {
          audio.pause();
        }
        audio.src = station.url;
        if (wasPlaying) {
          audio.play().catch(() => {});
        } else {
          statusEl.textContent = "Ready ‚Äî press play";
        }
      }

      // ‚îÄ‚îÄ Playback controls ‚îÄ‚îÄ
      function togglePlay() {
        if (!currentStation) {
          selectStation(0); // default to Beu FM
        }
        if (isPlaying) {
          audio.pause();
          isPlaying = false;
          playBtn.textContent = "‚ñ∂";
          statusEl.textContent = "Paused";
          stopViz();
        } else {
          if (!audio.src && currentStation) audio.src = currentStation.url;
          statusEl.textContent = "Buffering...";
          audio
            .play()
            .then(() => {
              isPlaying = true;
              playBtn.textContent = "‚è∏";
              statusEl.textContent = "Playing";
              startViz();
            })
            .catch((err) => {
              statusEl.textContent = "Error: " + err.message;
            });
        }
      }

      function setVolume(val) {
        audio.volume = val;
      }

      audio.addEventListener(
        "waiting",
        () => (statusEl.textContent = "Buffering..."),
      );
      audio.addEventListener("playing", () => {
        statusEl.textContent = "Playing";
        isPlaying = true;
        playBtn.textContent = "‚è∏";
        startViz();
      });
      audio.addEventListener(
        "error",
        () => (statusEl.textContent = "Stream error ‚Äî try another station"),
      );

      // ‚îÄ‚îÄ Simple visualizer (simulated ‚Äî real one requires CORS-friendly stream) ‚îÄ‚îÄ
      let vizInterval;
      function startViz() {
        stopViz();
        vizInterval = setInterval(() => {
          vizBars.forEach((bar) => {
            const h = Math.random() * 28 + 4;
            bar.style.height = h + "px";
            bar.classList.add("active");
          });
        }, 150);
      }

      function stopViz() {
        clearInterval(vizInterval);
        vizBars.forEach((bar) => {
          bar.style.height = "4px";
          bar.classList.remove("active");
        });
      }

      // Auto-select first station
      selectStation(0);
    </script>
  </body>
</html>
